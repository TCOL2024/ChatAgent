<!DOCTYPE html>
<html lang="de" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dein persÃ¶nlicher Assistent</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    :root {
      --primary-color: #4f46e5;
      --primary-dark: #4338ca;
      --secondary-color: #f3f4f6;
      --text-color: #1f2937;
      --light-text: #6b7280;
      --background: #f9fafb;
      --card-bg: #ffffff;
      --border-color: #e5e7eb;
      --radius: 12px;
      --transition: all 0.3s ease;
    }

    [data-theme="dark"] {
      --primary-color: #818cf8;
      --primary-dark: #6366f1;
      --secondary-color: #1f2937;
      --text-color: #f3f4f6;
      --light-text: #9ca3af;
      --background: #111827;
      --card-bg: #1f2937;
      --border-color: #374151;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--background);
      color: var(--text-color);
      margin: 0;
    }

    .main-header {
      background-color: var(--card-bg);
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border-color);
    }

    .intro-text {
      background: var(--card-bg);
      margin: 1rem;
      padding: 1rem;
      border-radius: var(--radius);
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      font-size: 0.9rem;
      color: var(--light-text);
    }

    .chat-container {
      max-width: 900px;
      margin: auto;
      padding: 1rem;
    }

    .chat-box {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      padding: 1rem;
      max-height: 70vh;
      overflow-y: auto;
    }

    .message {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      align-items: flex-start;
    }

    .message.user {
      justify-content: flex-end;
    }

    .message.user .avatar {
      order: 2;
      background-color: var(--primary-color);
      color: white;
    }

    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .bubble {
      max-width: 70%;
      background-color: var(--secondary-color);
      padding: 0.75rem;
      border-radius: var(--radius);
      white-space: pre-wrap;
    }

    .message.user .bubble {
      background-color: var(--primary-color);
      color: white;
    }

    .bubble table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.5rem;
    }

    .bubble table, .bubble th, .bubble td {
      border: 1px solid var(--border-color);
    }

    .bubble th, .bubble td {
      padding: 0.5rem;
    }

    .input-container {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: var(--card-bg);
      border-top: 1px solid var(--border-color);
      padding: 1rem;
    }

    .input-wrapper {
      max-width: 900px;
      margin: auto;
      display: flex;
      gap: 1rem;
    }

    textarea {
      flex: 1;
      padding: 0.75rem;
      font-family: inherit;
      border-radius: var(--radius);
      border: 1px solid var(--border-color);
    }

    .send-button {
      background: var(--primary-color);
      border: none;
      color: white;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .header-actions select,
    .header-actions button {
      margin-left: 0.5rem;
      padding: 0.5rem;
      border-radius: var(--radius);
      border: 1px solid var(--border-color);
      background: var(--secondary-color);
    }

    .suggestions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
      justify-content: center;
    }

    .suggestion-btn {
      padding: 0.5rem 1rem;
      background: var(--secondary-color);
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header class="main-header">
    <h1 id="mainTitle">Willkommen in Deinem Chat zu Personalmanagement</h1>
    <div class="header-actions">
      <button onclick="toggleTheme()">ðŸŒ—</button>
      <select id="langSwitcher" onchange="switchLanguage(this.value)">
        <option value="de">ðŸ‡©ðŸ‡ª DE</option>
        <option value="en">ðŸ‡¬ðŸ‡§ EN</option>
        <option value="es">ðŸ‡ªðŸ‡¸ ES</option>
        <option value="tr">ðŸ‡¹ðŸ‡· TR</option>
      </select>
      <button onclick="window.print()">ðŸ–¨</button>
      <button onclick="exportPDF()">ðŸ“„</button>
      <button onclick="resetChat()">ðŸ”„</button>
    </div>
  </header>
  <div class="intro-text" id="introText"></div>
  <main class="chat-container">
    <div class="chat-box" id="chatBox"></div>
    <div class="suggestions" id="suggestions"></div>
  </main>
  <div class="input-container">
    <div class="input-wrapper">
      <textarea id="userInput" placeholder="Deine Nachricht..."></textarea>
      <button class="send-button" id="sendButton"><i class="fas fa-paper-plane"></i></button>
    </div>
  </div>
  <script>
    const chatBox = document.getElementById("chatBox");
    const userInput = document.getElementById("userInput");
    const sendButton = document.getElementById("sendButton");
    const introText = document.getElementById("introText");
    const langTexts = {
      de: "Herzlich willkommen bei Deinem Chatbot. Mit Hilfe von kÃ¼nstlicher Intelligenz unterstÃ¼tze ich Dich bei Fragen rund um das Personalmanagement.\nStelle Deine Frage so spezifisch wie mÃ¶glich. Ich bin noch im Trainingsmodus, daher weiÃŸ ich noch nicht alles.\nFrage einfach und nutze dazu das Textfeld unten. Beschreibe wer Du bist, z.â€¯B. 'Ich bin Teilnehmer des Kurses Handelsfachwirt und habe eine Frage zur Ausbildung, meine Frage lautet konkret: [...]'",
      en: "Welcome to your chatbot. I'm here to support you with your questions on human resources management.\nAsk your question as specifically as possible. I'm still learning, so I might not know everything yet.\nJust type below and let me know who you are. For example: 'I'm a participant in the management course and I have a question about training: [...]'",
      es: "Bienvenido a tu chatbot. Estoy aquÃ­ para ayudarte con tus preguntas sobre la gestiÃ³n del personal.\nHaz tu pregunta lo mÃ¡s especÃ­fica posible. TodavÃ­a estoy en fase de entrenamiento, asÃ­ que puede que no lo sepa todo.\nSimplemente escribe abajo y dime quiÃ©n eres. Por ejemplo: 'Soy estudiante del curso de direcciÃ³n y tengo una pregunta sobre formaciÃ³n: [...]'",
      tr: "Chatbot'una hoÅŸ geldin. Ä°nsan kaynaklarÄ± yÃ¶netimi hakkÄ±nda sorularÄ±nÄ± yanÄ±tlamak iÃ§in buradayÄ±m.\nSorunu mÃ¼mkÃ¼n olduÄŸunca aÃ§Ä±k bir ÅŸekilde sor. Hala Ã¶ÄŸrenme aÅŸamasÄ±ndayÄ±m, bu yÃ¼zden her ÅŸeyi bilmiyor olabilirim.\nAÅŸaÄŸÄ±ya yazman yeterli. Ã–rneÄŸin: 'YÃ¶netim kursuna katÄ±lan bir Ã¶ÄŸrenciyim ve eÄŸitimle ilgili bir sorum var: [...]'"
    };

    const suggestions = [
      "Was sind gute FÃ¼hrungsstile?",
      "Wie gelingt Onboarding?",
      "Was ist ein guter Weiterbildungsplan?",
      "Wie spreche ich eine KÃ¼ndigung richtig an?"
    ];

    function showSuggestions() {
      const container = document.getElementById("suggestions");
      container.innerHTML = "";
      suggestions.forEach(text => {
        const btn = document.createElement("button");
        btn.className = "suggestion-btn";
        btn.textContent = text;
        btn.onclick = () => handleUserMessage(text);
        container.appendChild(btn);
      });
    }

    function toggleTheme() {
      const html = document.documentElement;
      html.dataset.theme = html.dataset.theme === "dark" ? "light" : "dark";
    }

    function switchLanguage(lang) {
      introText.textContent = langTexts[lang];
    }

    function resetChat() {
      chatBox.innerHTML = "";
      localStorage.removeItem("userName");
      askForName();
    }

    function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 10;
      const messages = chatBox.querySelectorAll(".message");
      messages.forEach(el => {
        const sender = el.classList.contains("user") ? "Du" : "KI";
        const text = el.querySelector(".bubble").innerText;
        doc.text(`${sender}: ${text}`, 10, y);
        y += 10;
      });
      doc.setFontSize(8);
      doc.text("Testmodus â€“ bitte sorgfÃ¤ltig prÃ¼fen. Alle Angaben sind unverbindlich.", 10, y + 10);
      doc.save("chat.pdf");
    }

    function askForName() {
      showBotResponse("Hallo, wie darf ich Dich ansprechen?");
    }

    function getInitials(name) {
      return name.split(" ").map(w => w[0]).join("").toUpperCase();
    }

    function handleUserMessage(message) {
      const name = localStorage.getItem("userName") || "Du";
      addMessage("user", message, name);
      if (!localStorage.getItem("userName")) {
        localStorage.setItem("userName", message);
        setTimeout(() => showBotResponse(`Danke, ${message}. Was kann ich fÃ¼r Dich tun?`), 500);
        return;
      }
      showBotResponse("ðŸ¤– ...");
      fetch("https://hook.us2.make.com/crk4yctny91n557tnx34f7tjtx9ycudp", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, question: message })
      })
      .then(res => res.text())
      .then(data => {
        document.querySelector(".message.bot .bubble").innerHTML = marked.parse(data);
      });
    }

    function addMessage(sender, text, name) {
      const msgDiv = document.createElement("div");
      msgDiv.className = `message ${sender}`;
      const avatarDiv = document.createElement("div");
      avatarDiv.className = "avatar";
      avatarDiv.textContent = sender === "user" ? getInitials(name) : "KI";
      const bubbleDiv = document.createElement("div");
      bubbleDiv.className = "bubble";
      bubbleDiv.innerHTML = sender === "bot" ? marked.parse(text) : text;
      msgDiv.appendChild(avatarDiv);
      msgDiv.appendChild(bubbleDiv);
      chatBox.appendChild(msgDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    sendButton.addEventListener("click", () => {
      const msg = userInput.value.trim();
      if (msg) {
        handleUserMessage(msg);
        userInput.value = "";
      }
    });

    userInput.addEventListener("keypress", e => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendButton.click();
      }
    });

    window.addEventListener("load", () => {
      switchLanguage("de");
      showSuggestions();
      if (localStorage.getItem("userName")) {
        showBotResponse(`Willkommen zurÃ¼ck, ${localStorage.getItem("userName")}. Was mÃ¶chtest Du wissen?`);
      } else {
        askForName();
      }
    });
  </script>
</body>
</html>
